{% load static %} 

<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PENSight - Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Alexandria:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.css" rel="stylesheet" />
</head>

<body class="h-screen flex flex-col bg-[radial-gradient(circle,_#3137cd_10%,_#f1eae7_100%)]">    
    <!-- Header -->
    <header class="w-full p-8 bg-[#464bd0] font-bold font-alexandria text-lg shadow-md flex items-center justify-between">
        <div class="flex items-center gap-3">
            <img src="{% static 'icon_page.svg'%}" class="w-20 h-auto" alt="Icon"> 
            <span class="text-3xl text-[#d9d9d9]">Hai Sobat PENSeek!!</span>
        </div>

        <div class="flex items-center gap-3">
            <span class="text-white text-3xl font-bold font-alexandria">MENU</span>
            <button onclick="toggleSidebar()" class="text-white hover:text-yellow-300 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" 
                    stroke="currentColor" class="w-10 h-10">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
    </header>   

    <div id="sidebar" class="fixed top-0 right-0 h-full w-72 bg-[#464bd0] text-white p-8 transform translate-x-full transition-transform duration-300 ease-in-out z-50">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-3xl font-bold font-alexandria">MENU</h2>
            <button onclick="toggleSidebar()" class="text-white text-2xl font-bold hover:text-yellow-300">
                &times;
            </button>
        </div>
        <ul class="space-y-4 text-lg font-alexandria">
            <li><a href="http://127.0.0.1:8000/" class="hover:text-yellow-300 font-semibold">Home</a></li>
            <li><a href="http://127.0.0.1:8000/about_page/" class="hover:text-yellow-300 font-semibold">Tentang PENSight</a></li>
            <li><a href="http://127.0.0.1:8000/kuota_prodi/" class="hover:text-yellow-300 font-semibold">Kuota Prodi</a></li>
            <li><a href="http://127.0.0.1:8000/input_page/" class="hover:text-yellow-300 font-semibold">Rekomendasi Prodi</a></li>
        </ul>
    </div>

    <div class="flex">
        <div class="flex-1 mt-20 ml-12">
            <!-- Minat dan Bakat -->
            <div class="flex items-center mt-4 ml-12">
                <span class="text-4xl font-[Alexandria] text-[#0a3d83]">Minat dan Bakat</span>
            </div>    

            <div class="flex gap-x-10 mt-10 ml-20">

                <!-- Minat dan Bakat -->
                <div class="relative w-1/2">
                    <div class="h-20 px-6 py-2 rounded-3xl border-2 border-[#0a3d83] text-[#0a3d83] font-semibold bg-white shadow-md">
                        <select id="minatBakat" name="minatBakat" multiple 
                            class="py-3 w-full h-full appearance-none bg-transparent text-xl outline-none"
                            placeholder="Pilih minat dan bakat"
                        >
                            <option value="Desain Animasi">Desain Animasi</option>
                            <option value="Desain Grafis">Desain Grafis</option>
                            <option value="Elektronika">Elektronika</option>
                            <option value="Fisika">Fisika</option>
                            <option value="Kimia">Kimia</option>
                            <option value="Matematika">Matematika</option>
                            <option value="Multimedia">Multimedia</option>
                            <option value="Pemrograman">Pemrograman</option>
                            <option value="Statistika">Statistika</option>
                            <option value="Teknik Instalasi Tenaga Listrik (TITL)">Teknik Instalasi Tenaga Listrik (TITL)</option>
                            <option value="Teknik Tenaga Listrik (TTL)">Teknik Tenaga Listrik (TTL)</option>
                            <option value="Teknologi Komputer Jaringan (TKJ)">Teknologi Komputer Jaringan (TKJ)</option>
                        </select>
                    </div>
                </div>

                <!-- Rencana Karir -->
                <div class="relative w-1/2">
                    <select id="pilihanKarir" 
                        class="w-full h-20 text-xl px-6 py-2 rounded-3xl border-2 border-[#0a3d83] text-[#0a3d83] font-semibold bg-white shadow-md appearance-none focus:ring-2 focus:ring-[#0a3d83]"
                        onfocus="document.getElementById('rencanaKarir').classList.add('rotate-180')"
                        onblur="document.getElementById('rencanaKarir').classList.remove('rotate-180')"
                        onchange="this.blur()"
                    >
                        <option selected disabled>Pilih Rencana Karir</option>
                        <option value="3D Modeler">3D Modeler</option>
                        <option value="Automation Engineer">Automation Engineer</option>
                        <option value="Broadcast Engineer">Broadcast Engineer</option>
                        <option value="Business Intelligence Analyst">Business Intelligence Analyst</option>
                        <option value="Cloud Engineer">Cloud Engineer</option>
                        <option value="Computer Engineer">Computer Engineer</option>
                        <option value="Control Systems Engineer">Control Systems Engineer</option>
                        <option value="Cybersecurity Analyst">Cybersecurity Analyst</option>
                        <option value="Data Scientist">Data Scientist</option>
                        <option value="DevOps Engineer">DevOps Engineer</option>
                        <option value="Digital Content Creator">Digital Content Creator</option>
                        <option value="Electrical Engineer">Electrical Engineer</option>
                        <option value="Electronics Technician">Electronics Technician</option>
                        <option value="Embedded Systems Engineer">Embedded Systems Engineer</option>
                        <option value="Energy Analyst">Energy Analyst</option>
                        <option value="Full Stack Developer">Full Stack Developer</option>
                        <option value="Game Designer">Game Designer</option>
                        <option value="Game Developer">Game Developer</option>
                        <option value="IT Support Specialist">IT Support Specialist</option>
                        <option value="Industrial Electrician">Industrial Electrician</option>
                        <option value="Machine Learning Engineer">Machine Learning Engineer</option>
                        <option value="Mechatronics Specialist">Mechatronics Specialist</option>
                        <option value="Motion Graphics Artist">Motion Graphics Artist</option>
                        <option value="Multimedia Designer">Multimedia Designer</option>
                        <option value="Network Engineer">Network Engineer</option>
                        <option value="Network Security Specialist">Network Security Specialist</option>
                        <option value="Power Plant Operator">Power Plant Operator</option>
                        <option value="RF Engineer">RF Engineer</option>
                        <option value="Renewable Energy Engineer">Renewable Energy Engineer</option>
                        <option value="Robotics Engineer">Robotics Engineer</option>
                        <option value="Software Engineer">Software Engineer</option>
                        <option value="System Administrator">System Administrator</option>
                        <option value="Telecommunications Specialist">Telecommunications Specialist</option>
                        <option value="UI/UX Designer">UI/UX Designer</option>
                        <option value="Video Editor">Video Editor</option>
                    </select>

                    <svg id="rencanaKarir" 
                        class="absolute top-8 right-6 w-6 h-6 pointer-events-none text-[#0a3d83] transition-transform duration-300" 
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>  
                </div>
            </div>

            <!-- Jalur Masuk -->
            <div class="flex items-center mt-12 ml-12">
                <span class="text-4xl font-[Alexandria] text-[#0a3d83]">Jalur Masuk dan Jenjang Pendidikan</span>
            </div>

            <div class="flex gap-x-10 mt-10 ml-20">
                <!-- Kolom Jalur Masuk -->
                <div class="relative w-1/2">
                    <select id="jalurMasukPens" 
                        class="w-full h-20 text-xl px-6 py-2 rounded-3xl border-2 border-[#0a3d83] text-[#0a3d83] font-semibold bg-white shadow-md appearance-none focus:ring-2 focus:ring-[#0a3d83]"
                        onfocus="document.getElementById('jalurMasuk').classList.add('rotate-180')"
                        onblur="document.getElementById('jalurMasuk').classList.remove('rotate-180')"
                        onchange="this.blur()"
                    >
                        <option selected disabled>Pilih Jalur Masuk</option>
                        <option value="SBMPN">SBMPN</option>
                        <option value="SNMPN">SNMPN</option>
                        <option value="SNMPTN/SBMPN">SNMPTN/SBMPN</option>
                        <option value="SBMPTN/SNBT">SBMPTN/SNBT</option>
                    </select>

                    <svg id="jalurMasuk" 
                        class="absolute top-8 right-6 w-6 h-6 pointer-events-none text-[#0a3d83] transition-transform duration-300" 
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>

                <!-- Kolom Jenjang Pendidikan -->
                <div class="relative w-1/2">
                    <select id="jenjangPendidikan" 
                        class="w-full h-20 text-xl px-6 py-2 rounded-3xl border-2 border-[#0a3d83] text-[#0a3d83] font-semibold bg-white shadow-md appearance-none focus:ring-2 focus:ring-[#0a3d83]"
                        onfocus="document.getElementById('jenjangArrow').classList.add('rotate-180')"
                        onblur="document.getElementById('jenjangArrow').classList.remove('rotate-180')"
                        onchange="this.blur()"
                    >
                        <option selected disabled>Pilih Jenjang</option>
                        <option value="D3">D3</option>
                        <option value="D4">D4</option>
                    </select>

                    <svg id="jenjangArrow" 
                        class="absolute top-8 right-6 w-6 h-6 pointer-events-none text-[#0a3d83] transition-transform duration-300" 
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
            </div>

            <!-- Rata-rata Nilai -->
            <div class="flex items-center mt-12 ml-12">
                <span class="text-4xl font-[Alexandria] text-[#0a3d83]">Rata-rata Nilai</span>
            </div>
            <div class="mt-10 ml-20 flex flex-wrap gap-4">
                    <input
                    id="nilaiInput" 
                    type="number" 
                    placeholder="Masukkan rata-rata nilai Anda" 
                    min="0" max="1000" 
                    class="w-full h-20 text-3xl px-6 pb-2 rounded-3xl border-2 border-[#0a3d83] text-[#0a3d83] font-semibold bg-white shadow-md placeholder-[#0a3d83] placeholder:font-semibold placeholder:text-xl focus:outline-none"
                    />
                    <p id="warningText" class="text-red-600 text-lg font-medium hidden">
                        Nilai harus antara 0 hingga 1000
                    </p>
            </div>
        </div>

        <div class="flex-1 mt-32 ml-36">
            <div class="ml-4 flex justify-between items-center cursor-pointer text-[#0a3d83] text-4xl font-[Alexandria]" onclick="toggleSection(this)">
                <span>Minat dan Bakat</span>
                <svg class="mr-40 arrow w-6 h-6 transition-transform duration-300" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M7 10l5 5 5-5z"/>
                </svg>
            </div>
            <hr class="border-t-4 border-[#0a3d83] w-5/6 mt-4"/>
            <div class="w-5/6 hidden mt-4 text-2xl font-semibold text-justify">
                Preferensi pribadi siswa terkait bidang yang disukai atau kuasai. Contoh: Pemrograman, Matematika, Fisika.
            </div>
            <div class="mt-20 ml-4 flex justify-between items-center cursor-pointer text-[#0a3d83] text-4xl font-[Alexandria]" onclick="toggleSection(this)">
                <span>Jalur Masuk</span>
                <svg class="mr-40 arrow w-6 h-6 transition-transform duration-300" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M7 10l5 5 5-5z"/>
                </svg>
            </div>
            <hr class="border-t-4 border-[#0a3d83] w-5/6 mt-4"/>
            <div class="w-5/6 hidden mt-4 text-2xl font-semibold text-justify">
                Jalur masuk yang diambil siswa saat mendaftar ke PENS            </div>
            <div class="mt-20 ml-4 flex justify-between items-center cursor-pointer text-[#0a3d83] text-4xl font-[Alexandria]" onclick="toggleSection(this)">
                <span>Rata-rata Nilai</span>
                <svg class="mr-40 arrow w-6 h-6 transition-transform duration-300" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M7 10l5 5 5-5z"/>
                </svg>
            </div>
            <hr class="border-t-4 border-[#0a3d83] w-5/6 mt-4"/>
            <div class="w-5/6 hidden mt-4 text-2xl font-semibold text-justify">
                Nilai rata-rata yang diperoleh siswa saat seleksi untuk masuk PENS. Contoh: jika SNBP = 86 atau bisa juga jika SNBT = 664.            </div>
            
            <!-- Tombol Submit -->
            <button onclick="kirimData()" id="rekomendasiBtn" class="ml-48 mt-20 bg-white mx-auto text-[Alexandria] text-[#0a3d83] px-8 py-4 rounded-full w-80 text-2xl font-bold outline outline-2 outline-[#0a3d83]] outline-offset-2 hover:bg-blue-700 hover:outline-blue-500">
                <a href="{% url 'result_page' %}">BERI REKOMENDASI</a>
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/js/tom-select.complete.min.js"></script>
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('translate-x-full');
        }

        function toggleSection(element) {
            const content = element.nextElementSibling.nextElementSibling;
            const arrow = element.querySelector('.arrow');
            content.classList.toggle('hidden');
            arrow.classList.toggle('rotate-180');
        }

        const input = document.getElementById("nilaiInput");
        const warning = document.getElementById("warningText");

        input.addEventListener("input", () => {
            const val = parseInt(input.value);
            if (val < 0 || val > 1000) {
            warning.classList.remove("hidden");
            } else {
            warning.classList.add("hidden");
            }
        });

        new TomSelect("#minatBakat", {
            plugins: ['remove_button'],
            persist: false,
            create: false,
            maxItems: 3,
            closeAfterSelect: false,
            render: {
                option: function(data, escape) {
                    return `<div>${escape(data.text)}</div>`;
                }
            }
        });

        function kirimData() {

        const data = {
            Jenjang_Pendidikan: document.getElementById("jenjangPendidikan").value,
            Minat_dan_Bakat: Array.from(document.getElementById("minatBakat").selectedOptions).map(opt => opt.value),
            Jalur_Pendaftaran_PENS: document.getElementById("jalurMasukPens").value,
            Rencana_Karir: document.getElementById("pilihanKarir").value,
            Rata_rata_Nilai_Masuk_PENS: parseFloat(document.getElementById("nilaiInput").value)
        };

        console.log("Contoh respon:", data);

        fetch("http://127.0.0.1:8000/api/rekomendasi_prodi", {
            method: "POST",
            headers: {
            "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
        .then(res => res.json())
        .then(response => {
            console.log("Respon dari API:", response);
            // Tampilkan hasil ke user
            // document.getElementById("hasilRekomendasi").innerText =
            //     "Rekomendasi Program Studi: " + response["Program Studi"];
        })
        .catch(error => {
            console.error("Error:", error);
            document.getElementById("hasilRekomendasi").innerText = "Terjadi kesalahan saat mengambil rekomendasi.";
        });
    };
    </script>
</body>
</html>
